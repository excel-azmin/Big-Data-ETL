{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_public",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ ref('item_ab2') }}
select
    {{ dbt_utils.surrogate_key([
        '_id',
        'idx',
        'mrp',
        adapter.quote('name'),
        array_to_string('uoms'),
        'uuid',
        'brand',
        'image',
        adapter.quote('owner'),
        array_to_string('taxes'),
        'doctype',
        array_to_string('barcodes'),
        'creation',
        'disabled',
        boolean_to_string('issynced'),
        'modified',
        'docstatus',
        'item_code',
        'item_name',
        'stock_uom',
        'thumbnail',
        'weightage',
        array_to_string(adapter.quote('attributes')),
        'item_group',
        'description',
        'end_of_life',
        'modified_by',
        array_to_string('bundle_items'),
        'has_batch_no',
        'has_variants',
        'max_discount',
        'minimumprice',
        'no_of_months',
        'safety_stock',
        'customer_code',
        'has_serial_no',
        'is_sales_item',
        'is_stock_item',
        array_to_string('item_defaults'),
        'min_order_qty',
        'naming_series',
        'opening_stock',
        'retain_sample',
        'website_image',
        'asset_category',
        array_to_string('customer_items'),
        'is_fixed_asset',
        'lead_time_days',
        'publish_in_hub',
        array_to_string('reorder_levels'),
        array_to_string('supplier_items'),
        'has_expiry_date',
        'sample_quantity',
        'show_in_website',
        'synced_with_hub',
        'warranty_period',
        'weight_per_unit',
        'create_new_batch',
        'is_item_from_hub',
        'is_purchase_item',
        'no_of_months_exp',
        'valuation_method',
        'variant_based_on',
        'country_of_origin',
        'has_excel_serials',
        'auto_create_assets',
        'shelf_life_in_days',
        'asset_naming_series',
        'saleswarrantymonths',
        'total_projected_qty',
        array_to_string('website_item_groups'),
        'delivered_by_supplier',
        'allow_alternative_item',
        'is_sub_contracted_item',
        'over_billing_allowance',
        'purchasewarrantymonths',
        array_to_string('website_specifications'),
        'enable_deferred_expense',
        'enable_deferred_revenue',
        'show_variant_in_website',
        'is_customer_provided_item',
        'default_material_request_type',
        'include_item_in_manufacturing',
        'standard_rate_aibyte_transform',
        'over_delivery_receipt_allowance',
        'valuation_rate_aibyte_transform',
        'inspection_required_before_delivery',
        'inspection_required_before_purchase',
        'last_purchase_rate_aibyte_transform',
    ]) }} as _airbyte_item_hashid,
    tmp.*
from {{ ref('item_ab2') }} tmp
-- item
where 1 = 1

