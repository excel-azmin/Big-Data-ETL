{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_public",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: {{ source('public', '_airbyte_raw_item') }}
select
    {{ json_extract_scalar('_airbyte_data', ['_id'], ['_id']) }} as _id,
    {{ json_extract_scalar('_airbyte_data', ['idx'], ['idx']) }} as idx,
    {{ json_extract_scalar('_airbyte_data', ['mrp'], ['mrp']) }} as mrp,
    {{ json_extract_scalar('_airbyte_data', ['name'], ['name']) }} as {{ adapter.quote('name') }},
    {{ json_extract_array('_airbyte_data', ['uoms'], ['uoms']) }} as uoms,
    {{ json_extract_scalar('_airbyte_data', ['uuid'], ['uuid']) }} as uuid,
    {{ json_extract_scalar('_airbyte_data', ['brand'], ['brand']) }} as brand,
    {{ json_extract_scalar('_airbyte_data', ['image'], ['image']) }} as image,
    {{ json_extract_scalar('_airbyte_data', ['owner'], ['owner']) }} as {{ adapter.quote('owner') }},
    {{ json_extract_array('_airbyte_data', ['taxes'], ['taxes']) }} as taxes,
    {{ json_extract_scalar('_airbyte_data', ['doctype'], ['doctype']) }} as doctype,
    {{ json_extract_array('_airbyte_data', ['barcodes'], ['barcodes']) }} as barcodes,
    {{ json_extract_scalar('_airbyte_data', ['creation'], ['creation']) }} as creation,
    {{ json_extract_scalar('_airbyte_data', ['disabled'], ['disabled']) }} as disabled,
    {{ json_extract_scalar('_airbyte_data', ['isSynced'], ['isSynced']) }} as issynced,
    {{ json_extract_scalar('_airbyte_data', ['modified'], ['modified']) }} as modified,
    {{ json_extract_scalar('_airbyte_data', ['docstatus'], ['docstatus']) }} as docstatus,
    {{ json_extract_scalar('_airbyte_data', ['item_code'], ['item_code']) }} as item_code,
    {{ json_extract_scalar('_airbyte_data', ['item_name'], ['item_name']) }} as item_name,
    {{ json_extract_scalar('_airbyte_data', ['stock_uom'], ['stock_uom']) }} as stock_uom,
    {{ json_extract_scalar('_airbyte_data', ['thumbnail'], ['thumbnail']) }} as thumbnail,
    {{ json_extract_scalar('_airbyte_data', ['weightage'], ['weightage']) }} as weightage,
    {{ json_extract_array('_airbyte_data', ['attributes'], ['attributes']) }} as {{ adapter.quote('attributes') }},
    {{ json_extract_scalar('_airbyte_data', ['item_group'], ['item_group']) }} as item_group,
    {{ json_extract_scalar('_airbyte_data', ['description'], ['description']) }} as description,
    {{ json_extract_scalar('_airbyte_data', ['end_of_life'], ['end_of_life']) }} as end_of_life,
    {{ json_extract_scalar('_airbyte_data', ['modified_by'], ['modified_by']) }} as modified_by,
    {{ json_extract_array('_airbyte_data', ['bundle_items'], ['bundle_items']) }} as bundle_items,
    {{ json_extract_scalar('_airbyte_data', ['has_batch_no'], ['has_batch_no']) }} as has_batch_no,
    {{ json_extract_scalar('_airbyte_data', ['has_variants'], ['has_variants']) }} as has_variants,
    {{ json_extract_scalar('_airbyte_data', ['max_discount'], ['max_discount']) }} as max_discount,
    {{ json_extract_scalar('_airbyte_data', ['minimumPrice'], ['minimumPrice']) }} as minimumprice,
    {{ json_extract_scalar('_airbyte_data', ['no_of_months'], ['no_of_months']) }} as no_of_months,
    {{ json_extract_scalar('_airbyte_data', ['safety_stock'], ['safety_stock']) }} as safety_stock,
    {{ json_extract_scalar('_airbyte_data', ['customer_code'], ['customer_code']) }} as customer_code,
    {{ json_extract_scalar('_airbyte_data', ['has_serial_no'], ['has_serial_no']) }} as has_serial_no,
    {{ json_extract_scalar('_airbyte_data', ['is_sales_item'], ['is_sales_item']) }} as is_sales_item,
    {{ json_extract_scalar('_airbyte_data', ['is_stock_item'], ['is_stock_item']) }} as is_stock_item,
    {{ json_extract_array('_airbyte_data', ['item_defaults'], ['item_defaults']) }} as item_defaults,
    {{ json_extract_scalar('_airbyte_data', ['min_order_qty'], ['min_order_qty']) }} as min_order_qty,
    {{ json_extract_scalar('_airbyte_data', ['naming_series'], ['naming_series']) }} as naming_series,
    {{ json_extract_scalar('_airbyte_data', ['opening_stock'], ['opening_stock']) }} as opening_stock,
    {{ json_extract_scalar('_airbyte_data', ['retain_sample'], ['retain_sample']) }} as retain_sample,
    {{ json_extract_scalar('_airbyte_data', ['website_image'], ['website_image']) }} as website_image,
    {{ json_extract_scalar('_airbyte_data', ['asset_category'], ['asset_category']) }} as asset_category,
    {{ json_extract_array('_airbyte_data', ['customer_items'], ['customer_items']) }} as customer_items,
    {{ json_extract_scalar('_airbyte_data', ['is_fixed_asset'], ['is_fixed_asset']) }} as is_fixed_asset,
    {{ json_extract_scalar('_airbyte_data', ['lead_time_days'], ['lead_time_days']) }} as lead_time_days,
    {{ json_extract_scalar('_airbyte_data', ['publish_in_hub'], ['publish_in_hub']) }} as publish_in_hub,
    {{ json_extract_array('_airbyte_data', ['reorder_levels'], ['reorder_levels']) }} as reorder_levels,
    {{ json_extract_array('_airbyte_data', ['supplier_items'], ['supplier_items']) }} as supplier_items,
    {{ json_extract_scalar('_airbyte_data', ['has_expiry_date'], ['has_expiry_date']) }} as has_expiry_date,
    {{ json_extract_scalar('_airbyte_data', ['sample_quantity'], ['sample_quantity']) }} as sample_quantity,
    {{ json_extract_scalar('_airbyte_data', ['show_in_website'], ['show_in_website']) }} as show_in_website,
    {{ json_extract_scalar('_airbyte_data', ['synced_with_hub'], ['synced_with_hub']) }} as synced_with_hub,
    {{ json_extract_scalar('_airbyte_data', ['warranty_period'], ['warranty_period']) }} as warranty_period,
    {{ json_extract_scalar('_airbyte_data', ['weight_per_unit'], ['weight_per_unit']) }} as weight_per_unit,
    {{ json_extract_scalar('_airbyte_data', ['create_new_batch'], ['create_new_batch']) }} as create_new_batch,
    {{ json_extract_scalar('_airbyte_data', ['is_item_from_hub'], ['is_item_from_hub']) }} as is_item_from_hub,
    {{ json_extract_scalar('_airbyte_data', ['is_purchase_item'], ['is_purchase_item']) }} as is_purchase_item,
    {{ json_extract_scalar('_airbyte_data', ['no_of_months_exp'], ['no_of_months_exp']) }} as no_of_months_exp,
    {{ json_extract_scalar('_airbyte_data', ['valuation_method'], ['valuation_method']) }} as valuation_method,
    {{ json_extract_scalar('_airbyte_data', ['variant_based_on'], ['variant_based_on']) }} as variant_based_on,
    {{ json_extract_scalar('_airbyte_data', ['country_of_origin'], ['country_of_origin']) }} as country_of_origin,
    {{ json_extract_scalar('_airbyte_data', ['has_excel_serials'], ['has_excel_serials']) }} as has_excel_serials,
    {{ json_extract_scalar('_airbyte_data', ['auto_create_assets'], ['auto_create_assets']) }} as auto_create_assets,
    {{ json_extract_scalar('_airbyte_data', ['shelf_life_in_days'], ['shelf_life_in_days']) }} as shelf_life_in_days,
    {{ json_extract_scalar('_airbyte_data', ['asset_naming_series'], ['asset_naming_series']) }} as asset_naming_series,
    {{ json_extract_scalar('_airbyte_data', ['salesWarrantyMonths'], ['salesWarrantyMonths']) }} as saleswarrantymonths,
    {{ json_extract_scalar('_airbyte_data', ['total_projected_qty'], ['total_projected_qty']) }} as total_projected_qty,
    {{ json_extract_array('_airbyte_data', ['website_item_groups'], ['website_item_groups']) }} as website_item_groups,
    {{ json_extract_scalar('_airbyte_data', ['delivered_by_supplier'], ['delivered_by_supplier']) }} as delivered_by_supplier,
    {{ json_extract_scalar('_airbyte_data', ['allow_alternative_item'], ['allow_alternative_item']) }} as allow_alternative_item,
    {{ json_extract_scalar('_airbyte_data', ['is_sub_contracted_item'], ['is_sub_contracted_item']) }} as is_sub_contracted_item,
    {{ json_extract_scalar('_airbyte_data', ['over_billing_allowance'], ['over_billing_allowance']) }} as over_billing_allowance,
    {{ json_extract_scalar('_airbyte_data', ['purchaseWarrantyMonths'], ['purchaseWarrantyMonths']) }} as purchasewarrantymonths,
    {{ json_extract_array('_airbyte_data', ['website_specifications'], ['website_specifications']) }} as website_specifications,
    {{ json_extract_scalar('_airbyte_data', ['enable_deferred_expense'], ['enable_deferred_expense']) }} as enable_deferred_expense,
    {{ json_extract_scalar('_airbyte_data', ['enable_deferred_revenue'], ['enable_deferred_revenue']) }} as enable_deferred_revenue,
    {{ json_extract_scalar('_airbyte_data', ['show_variant_in_website'], ['show_variant_in_website']) }} as show_variant_in_website,
    {{ json_extract_scalar('_airbyte_data', ['is_customer_provided_item'], ['is_customer_provided_item']) }} as is_customer_provided_item,
    {{ json_extract_scalar('_airbyte_data', ['default_material_request_type'], ['default_material_request_type']) }} as default_material_request_type,
    {{ json_extract_scalar('_airbyte_data', ['include_item_in_manufacturing'], ['include_item_in_manufacturing']) }} as include_item_in_manufacturing,
    {{ json_extract_scalar('_airbyte_data', ['standard_rate_aibyte_transform'], ['standard_rate_aibyte_transform']) }} as standard_rate_aibyte_transform,
    {{ json_extract_scalar('_airbyte_data', ['over_delivery_receipt_allowance'], ['over_delivery_receipt_allowance']) }} as over_delivery_receipt_allowance,
    {{ json_extract_scalar('_airbyte_data', ['valuation_rate_aibyte_transform'], ['valuation_rate_aibyte_transform']) }} as valuation_rate_aibyte_transform,
    {{ json_extract_scalar('_airbyte_data', ['inspection_required_before_delivery'], ['inspection_required_before_delivery']) }} as inspection_required_before_delivery,
    {{ json_extract_scalar('_airbyte_data', ['inspection_required_before_purchase'], ['inspection_required_before_purchase']) }} as inspection_required_before_purchase,
    {{ json_extract_scalar('_airbyte_data', ['last_purchase_rate_aibyte_transform'], ['last_purchase_rate_aibyte_transform']) }} as last_purchase_rate_aibyte_transform,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at
from {{ source('public', '_airbyte_raw_item') }} as table_alias
-- item
where 1 = 1

